{
  "filename": "Module 5 - Extra Talk - IoTSecWhatWhyHow.pdf",
  "text": "IoT Security  What, Why, How\nEarlence Fernandes\n2\nYour car is a computer with wheels and an engine\nYour refrigerator is a computer that keeps food cold\nYour ATM is a computer with money inside\n-- Bruce Schneier to the US House Committee on Energy and Commerce\n2016\n3\n4\nCourtesy: Microsoft Genome Project\nhttps://msdn.microsoft.com/en-us/library/dd393313.aspx\nAutomated Data Center Cooling Management\nDemand Response; Increased Renewables \nUsage\nSmart Cities\nData-Driven Agriculture\nFarmBeats Platform, \nNSDI 2017\nHospital Efficiency and Effectiveness\nTrack meds for elderly\nRealtime location\nAutonomous Vehicles\nWearables\nIndustrial Internet\n5\nPeak of Inflated Expectations\nPlateau of Productivity\nSlope of Enlightenment\nTrough of Disillusionment\nTechnology Trigger\nVISIBILITY\nTIME\nIoT\nWe must address security problems \nin the Internet of Things\n6\n7\nAttacks on the Internet of Things\nMirai botnet used IP \nCameras/DVRs to \nlaunch DDoS\nMirai disabled heating \nfor building residents \nin Finland\n200,000 residences \nlost power for 3 hours\nAttacks on the Internet of Things\n8\nAttacks Closer to Home\n9\nFlooding [1]\nRemotely determine \nprime time for \nBurglary [1,2]\nOR\n[1] Denning et al., Computer Security and the Modern Home, CACM’13\n[2] FTC Internet of Things Report’15\nDevices\nProtocols\nHow might we tackle the IoT security problem?\nWhat are the new intellectual challenges?\n10\nThe Internet of Things Stack\n11\nApplication\nDomains\nDevices/\nHardware\nConnectivity \nProtocols/\nNetwork\nIoT\nPlatforms/\nSystem Software\nInteroperability, Sensing Mgmt, Data Analysis, Control\nUsability \nIssues\nDevice/Hardware Layer Challenges\n12\nMichigan Micro Mote (M3)\nSmart Cards/RFID Tags\nResource Constraints \n(Energy, Hardware Features, Computation, …)\nPrivilege Levels, Memory Management Unit, \nTrusted Execution (SGX, TrustZone, …), \nSecure Randomness, Secure Clocks, …\napply\napply\n[1] A. Rahmati et al., Time and Remanence Decay in SRAM to implement \nsecure protocols on embedded devices without clocks, USENIX Sec 2012\nHow can we measure the passage of time? [1]\nDevice/Hardware Layer Challenges\n• Core notions of hardware security mechanisms: Similar to other \ncomputing paradigms\n• Resource Constraints of IoT devices => Affect higher-layer security \nproperties\n• Higher-layer security properties => Tuned to manage resource \nconstraints\n13\nHardware-Software Co-Design Approach\nNetwork Layer Challenges\n14\nPower Line Communication\nVisible Light \nCommunication\nConnectivity Protocol Diversity\nTechnology Infancy\nEnvironmental Constraints \n(e.g., no additional infrastructure)\nResource Constraints (e.g., energy)\nAffects Network Security Practices\nCase Study: Port Scanning\n15\nTCP Ports\nBLE UUIDs\nBLE Device\n(disconnected)\nScanner\nAdvert (rudimentary)\nAdvert (rudimentary)\nAdvert (rudimentary)\nBLE Device\n(connected)\nAs each protocol has its own notions of how two peers communicate with each \nother, it is unclear how network security practices such as port scanning translate to \nnetworks of devices that use various IoT protocols\nRepurposing Networking Tech. In New Ways\n16\nThe hub-model of Smart Homes\nRe-purpose the WiFi Router [1]\n[1] A. Simpson et al., Securing vulnerable home iot devices with an in-hub security manager, University of Washington, \nTechnical Report UW-CSE-17-01-01, Jan. 2017\nHow do we make sure that only a WiFi-enabled a presence detector and nothing else affects a WiFi door lock?\nCan we patch security vulns at the network layer for unpatchable IoT devices?\nPhysical Principles for Network Anomaly Det.\n17\nTypical Network\nGeneral Purpose Computing Devices => \nErrors in Anomaly Detectors\nIoT Network\nSpecialized Computing Devices => \nPossibly Less Errors\nPhysical devices/processes evolve as per physical laws. \nCan we leverage this knowledge to build a model and then use it to reduce errors in \nanomaly detectors?\nIoT Platform Layer Challenges\n18\nProcess Isolation\nAccess Control\nInformation Flow Control\nUpdates\nAuthentication\nIoT Platform Layer Challenges\n19\nProcess Isolation\nAccess Control\nInformation Flow Control\nUpdates\nAuthentication\nHail Dev Module\nIMIX Dev Module\nnRF51-DK Dev Module\nLanguage Type Safety + Memory Protection Units = Tock OS [1]\n[1] A. Levy et al., Ownership is theft: Experiences building an embedded OS in Rust, in PLOS’15\nUltra-Resource Constrained Devices. E.g., sensors in a bridge, 64K RAM\nIoT Platform Layer Challenges\n20\nProcess Isolation\nAccess Control\nInformation Flow Control\nUpdates\nAuthentication\nAnalysis of SmartThings [1]\n• Why SmartThings?\n• Relatively Mature (2012)\n• 521 SmartApps\n• 132 device types\n• Shares design principles with other existing, nascent frameworks\n21\nAccess\nControl\nEvent-Based\nProgramming\n• What is SmartThings?\n• Home automation platform\n• Wirelessly control door locks, motion sensors, music players, …\n• Supports third-party apps\nSmartThings\nCloud\nHub\nHub\nHub\nDevices\n…\n[1] E. Fernandes et al., Security Analysis of Emerging Smart Home Applications, S&P 2016\nSmartThings Primer\n22\nWiFi\nZWave\nSmartThings \nCompanion App\nConfigure\nControl\nSmartThings Cloud Platform\nSmartApp\nSmartDevice\nGroovy-Based\nSandbox\nGroovy-Based\nSandbox\nCapability\nSystem\n[Cmd/Attr]\n[Events]\nHTTPS \nGET/PUT\nInternet \nAPI\nSMS\nAPI\nWhat makes this analysis challenging?\n23\n•\nDesign Documents & Technical \nReports\n•\nPlatform Analysis Toolchains\n•\nDynamic Instrumentation\n•\nStatic Analysis of Platform Code\n•\nNo public design documents\n•\nClosed source: cannot use existing \nanalysis toolchains\n•\nCloud platform has limited public \ninterface\nAnalysis Methodology & Threat Model\n24\nSmartThings Cloud Platform\nSmartApp\nSmartDevice\nGroovy-Based\nSandbox\nGroovy-Based\nSandbox\nCapability\nSystem\n[Cmd/Attr]\n[Events]\nHTTPS \nGET/PUT\nInternet \nAPI\nSMS\nAPI\nBlack-box API Testing w/ Apps + Crash-Log Analysis (along 5 principles)\nStatic Code Analysis of SmartApps (our toolchain, our dataset)\nSecurity Eval. of SmartThings: Our Results\n25\nSecurity Analysis Area\nFinding\nOverprivilege in Apps\nTwo Types of Automatic Overprivilege\nEvent System Security\nEvent Snooping and Spoofing\nThird-party Integration Safety\nIncorrect OAuth Can Lead to Attacks\nExternal Input Sanitization\nGroovy Command Injection Attacks\nAPI Access Control\nNo Access Control around SMS/Internet API\nEmpirical Analysis of 499 Apps\n> 40% of apps exhibit overprivilege of \natleast one type (55%, 43%)\nProof of Concept Attacks\nPincode Injection and Snooping, Disabling \nVacation Mode, Fake Fire Alarms\nCapability System\n26\nUntrusted\nSmartApp\nZWave Lock SmartDevice\ncapability.lock\ncapability.lockCodes\ncapability.battery\n…\nSend commands\nRead/set attributes\nReceive events\nCapability\nCommands\nAttributes\ncapability.lock\nlock(), unlock()\nlock (lock status)\ncapability.battery\nN/A\nbattery (battery \nstatus)\nUsability\nSimpler Coarser Capabilities\nSecurity\nFine-Grained Capabilities\nEase of Development\nExpressive Functionality\nExploiting Design Flaws in SmartThings\n27\nOverprivilege\nCommand \nInjection\nOAuth \nCompromise\nEvent \nSpoofing\nUnrestricted \nSMS API\nPincode\nInjection\nPopular Existing SmartApp \nwith Android companion \napp; Unintended action of \nsetCode() on lock\nBackdoor Pincode Injection Attack\n28\nWebService\nSmartApp\nHTTP PUT\nHTTP GET\nclient_id\nclient_secret\nmappings {\npath(“/devices/:id”) { action: \n[ PUT: “updateDevice” ]\n}\ndef updateDevice() \n{\ndef cmd = request.JSON.command\ndef args = request.JSON.arguments\n// code truncated\ndevice.”$cmd”(*args)\n}\n{\ncommand: setCode,\narguments: [3, ‘3456’]\n}\nDynamic Method\nExploiting Design Flaws in SmartThings\n29\nOverprivilege\nCommand \nInjection\nOAuth \nCompromise\nEvent \nSpoofing\nUnrestricted \nSMS API\nPincode\nInjection\nPincode\nSnooping\nPopular Existing SmartApp \nwith Android companion \napp; Unintended action of \nsetCode() on lock\nStealthy malware SmartApp; \nONLY requests \ncapability.battery\nDisabling \nVacation \nMode\nFake CO \nAlarm\nMalware SmartApps with no capabilities; \nGives impression of reduced reliability\n30\nWhat did we learn from the attacks/analysis?\n•\nApp-Device bindings can be more precise without changing UX       \n[Coarse SmartApp-SmartDevice Binding Overprivilege]\n•\nFixing of event system overprivilege is a by-product\n•\nRisk-based Capabilities/Permission => Fundamental Risk Asymmetry\n•\nPermissions are only useful as a first line of defense for IoT platforms, \ncan we do better?\nDevice\nAuthorized\nNot authorized\n[cap.battery]\nuser-view\nplatform-view\nIoT Platform Layer Challenges\n31\nProcess Isolation\nAccess Control\nInformation Flow Control\nUpdates\nAuthentication\n• Restructure apps in terms of information flows\n• Apps request point-to-point flows instead of individual \npermissions\n32\nDynamic labeling scheme\nProgrammer-defined tracking granularity\nSupports existing tools, languages, IDEs; no changes to OS\nFlowFence [1]\nflow tracking is a first-class primitive\nCamera data only used to activate door lock\nSensitive Function\nQuarantined Module\n< L_CameraData, CameraData >\nOPAQUE_HANDLE(Sensitive Return)\nsandbox\n• Language-level primitive to isolate and \nflow-track sensitive code\n[1] E. Fernandes et al., FlowFence: Practical Data Protection for Emerging IoT Application Frameworks, USENIX Security 2016\nA Spectrum of Information Flow Tracking\n33\nArchitecture Level \n(Instructions, Gates)\nResource Overhead; Special Hardware\nRIFLE, Execution Leases, …\nOS-Based DIFC\n(Page/Process Level Tracking)\nMay Overtaint; Coarse-Control\nHiStar, Asbestos, Flume, …\nLanguage-Based DIFC\n(Type Systems, Variable-Level Tracking)\nDev. Learning Curve; Limited Control \nover External Resources\nJif, Jeeves, …\n“Component-Level” DIFC\n(Well-defined component-level tracking)\nCombines PL & OS Techniques\nLaminar, COWL, Aeolus …\nChallenge: Applying flow tracking principles \nto a specific domain\n34\nTrigger\nProcess\nAction\nUr et al., Practical Trigger-Action Programming in the Smart Home, CHI’14\nRuntime Binding of \nActual \nResource/Device\nDevice \nIndependence\nIoT Platform Layer Challenges\n35\nProcess Isolation\nAccess Control\nInformation Flow Control\nUpdates\nAuthentication\nUpdates should be careful and planned => Economic Impact or Worse\nIoT Platform Layer Challenges\n36\nProcess Isolation\nAccess Control\nInformation Flow Control\nUpdates\nAuthentication\nUpdates should be careful and planned => Economic Impact or Worse\nIoT devices in the field could be intermittently powered => How to update during \npower losses?\nIoT devices may not be updateable fundamentally [1] => no infrastructure was built \nby manufacturer\n[1] T. Yu et al., Handling a trillion (unfixable) flaws on a billion devices: Rethinking network security for the \ninternet-of-things, HotNets-XIV.\nIoT Platform Layer Challenges\n37\nProcess Isolation\nAccess Control\nInformation Flow Control\nUpdates\nAuthentication\nWeak Passwords\nDefault Password (Mirai)\nPassword Re-use\nClient Side Password Strength Estimators\ne.g., https://github.com/dropbox/zxcvbn\nApplication Layer Challenges\n• Physical Co-Relations\n• E.g., Garage door closes, nearby speaker picks up acoustic pattern\n• E.g., Vehicle speed increases, change in engine vibration patterns\n• Machine Learning [1] for Control\n• E.g., Robots\n• E.g., Autonomous Vehicles\n38\n[1] N. Papernot et al., Towards the science of security and privacy in machine learning, CoRR, vol. abs/1611.03814, 2016.\nThe Internet of Things Stack\n39\nApplication\nDomains\nDevices/\nHardware\nConnectivity \nProtocols/\nNetwork\nIoT\nPlatforms/\nSystem Software\nUsable \nSecurity \nIssues\nIoT Security  What, Why, How\nEarlence Fernandes\nearlenceferns@gmail.com\nhttps://web.eecs.umich.edu/~earlence/\nhttps://iotsecurity.eecs.umich.edu\nhttps://www.safethings.info/\nIoT Security Research: A Rehash of Old Ideas or New Intellectual Challenges?\nE. Fernandes, A. Rahmati, K. Eykholt, A. Prakash\narXiv 2017\nConsider \nSubmitting\n"
}